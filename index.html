<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test game</title>
    <script src="https://vk.com/js/api/xd_connection.js?2"  type="text/javascript"></script>
</head>
<body>
<script type="text/javascript">
    function getQueryParam(item) {
        const svalue = window.location.search.match(new RegExp('[\?\&]' + item + '=([^\&]*)(\&?)', 'i'));
        return svalue ? svalue[1] : svalue;
    }
    function init() {
        return new Promise((resolve, reject) => {
            VK.init(function() {
                console.log(VK, 'successfully');
                console.log(location.search);
                const options = {
                    access_token: getQueryParam(location.search)
                };
                resolve(options);
            }, function() {
                console.log('failed');
                reject();
            }, '5.103');
        });
    }
    init().then((options) => {
        VK.api("account.getProfileInfo", { access_token: options.access_token, v: '5.103'}, (response) => console.log(response));
    })
</script>
</body>
</html>
